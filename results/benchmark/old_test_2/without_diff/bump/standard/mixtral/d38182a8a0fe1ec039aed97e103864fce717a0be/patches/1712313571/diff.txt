2,10c2,27
< @org.junit.jupiter.api.Test
< void testScope() {
<     final java.lang.String line = "GET /resource.txt HTTP/1.1";
<     final java.lang.String action = "foo:bar:baz";
<     final java.util.concurrent.atomic.AtomicReference<java.lang.String> caction = new java.util.concurrent.atomic.AtomicReference<>();
<     final java.util.concurrent.atomic.AtomicReference<java.lang.String> cline = new java.util.concurrent.atomic.AtomicReference<>();
<     new com.artipie.docker.http.AuthScopeSlice(new com.artipie.docker.http.ScopeSlice() {
<         @java.lang.Override
<         public com.artipie.docker.http.Scope scope(final java.lang.String rqline) {
---
> package com.artipie.docker.http;
> 
> import com.artipie.http.auth.Authentication;
> import com.artipie.http.auth.SingleUser;
> import org.hamcrest.MatcherAssert;
> import org.junit.jupiter.api.Test;
> import java.nio.ByteBuffer;
> import java.util.Collections;
> import java.util.Map;
> import java.util.concurrent.CompletableFuture;
> import java.util.concurrent.ExecutionException;
> import java.util.concurrent.atomic.AtomicReference;
> import io.reactivex.Publisher;
> import static com.artipie.http.Response.Status.OK;
> import static com.artipie.http.rs.StandardRs.OK_;
> import static org.hamcrest.core.IsEqual.equalTo;
> 
> @Test
> void testScope() throws ExecutionException, InterruptedException {
>     final String line = "GET /resource.txt HTTP/1.1";
>     final String action = "foo:bar:baz";
>     final AtomicReference<String> caction = new AtomicReference<>();
>     final AtomicReference<String> cline = new AtomicReference<>();
>     new AuthScopeSlice(new ScopeSlice() {
>         @Override
>         public Scope scope(String rqline) {
12c29
<             return new com.artipie.docker.http.Scope.FromString(action);
---
>             return new Scope.FromString(action);
15,17c32,34
<         @java.lang.Override
<         public com.artipie.http.Response response(final java.lang.String line, final java.lang.Iterable<java.util.Map.Entry<java.lang.String, java.lang.String>> headers, final org.reactivestreams.Publisher<java.nio.ByteBuffer> body) {
<             return com.artipie.http.rs.StandardRs.OK;
---
>         @Override
>         public Response response(String line, Iterable<Map.Entry<String, String>> headers, Publisher<ByteBuffer> body) {
>             return OK_;
19,20c36
<     }, ( headers, rline) -> java.util.concurrent.CompletableFuture.completedFuture(new com.artipie.http.auth.Authentication.SingleUser("alice", "")),
<     ( user, act) -> {
---
>     }, (headers, rline) -> CompletableFuture.completedFuture(new Authentication.SingleUser("alice", "")), (user, act) -> {
23,25c39,41
<     }).response(line, com.artipie.http.Headers.EMPTY, com.artipie.asto.Content.EMPTY).send(( status, headers, body) -> java.util.concurrent.CompletableFuture.allOf()).toCompletableFuture().join();
<     org.hamcrest.MatcherAssert.assertThat("Request line passed to slice", cline.get(), new org.hamcrest.core.IsEqual<>(line));
<     org.hamcrest.MatcherAssert.assertThat("Scope passed as action to permissions", caction.get(), new org.hamcrest.core.IsEqual<>(action));
---
>     }).response(line, Collections.emptyMap(), Collections.emptyList()).send((status, headers, body) -> CompletableFuture.allOf()).toCompletableFuture().join();
>     MatcherAssert.assertThat("Request line passed to slice", cline.get(), equalTo(line));
>     MatcherAssert.assertThat("Scope passed as action to permissions", caction.get(), equalTo(action));
