import org.bouncycastle.crypto.tls.TlsFatalAlert;
import java.io.IOException;

public class ChachaDecoder {
    // existing code

    private void decode(byte[] input, int length) throws IOException {
        // existing code

        if (version == TlsConstants.VERSION_13) {
            if (type == TlsUtilities.Chacha20Poly1305) {
                if (input[2] == 1) {
                    throw new TlsFatalAlert(TlsFatalAlert.DECODE_ERROR);
                }
            }
        }

        // existing code
    }
}