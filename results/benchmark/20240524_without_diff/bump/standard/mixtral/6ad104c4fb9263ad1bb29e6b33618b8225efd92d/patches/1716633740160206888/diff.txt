1a2,39
> 
> import org.bouncycastle.tls.TlsContext;
> import org.bouncycastle.tls.crypto.TlsCrypto;
> import org.bouncycastle.tls.crypto.impl.TlsCryptoParameters;
> import org.bouncycastle.tls.crypto.impl.jcajce.JcaTlsCrypto;
> import org.bouncycastle.tls.crypto.impl.jcajce.JceTlsCryptoProvider;
> import org.bouncycastle.util.io.pem.PemObject;
> import org.bouncycastle.util.io.pem.PemReader;
> 
> import java.io.FileReader;
> import java.security.KeyFactory;
> import java.security.PrivateKey;
> import java.security.spec.PKCS8EncodedKeySpec;
> 
> public class ChachaDecoder {
>     private TlsCrypto crypto;
> 
>     public ChachaDecoder(String privateKeyPath) throws Exception {
>         JceTlsCryptoProvider provider = new JceTlsCryptoProvider();
>         crypto = new JcaTlsCrypto(provider);
> 
>         PemReader reader = new PemReader(new FileReader(privateKeyPath));
>         PemObject obj = reader.readPemObject();
>         byte[] encoded = obj.getContent();
> 
>         PKCS8EncodedKeySpec keySpec = new PKCS8EncodedKeySpec(encoded);
>         KeyFactory kf = KeyFactory.getInstance("RSA");
>         PrivateKey privateKey = kf.generatePrivate(keySpec);
> 
>         TlsCryptoParameters cryptoParams = new TlsCryptoParameters();
>         cryptoParams.setPrivateKey(privateKey);
>         crypto.setCryptoParameters(cryptoParams);
>     }
> 
>     public byte[] decode(byte[] input) throws Exception {
>         // ...
>     }
> }
\ No newline at end of file
