import java.io.ByteArrayInputStream;
import java.io.IOException;
import java.nio.ByteBuffer;
import java.security.GeneralSecurityException;
import java.util.Arrays;

import javax.crypto.Cipher;
import javax.crypto.CipherInputStream;
import javax.crypto.spec.IvParameterSpec;
import javax.crypto.spec.SecretKeySpec;

public class ChachaDecoder {
    // ... other code ...

    private byte[] decryptChacha20Poly1305(byte[] ciphertext, byte[] key, byte[] iv) throws IOException, GeneralSecurityException {
        // ... other code ...
    }

    // ... other code ...
}