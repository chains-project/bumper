1c1,33
< import org.bouncycastle.crypto.tls.TlsFatalAlert;
\ No newline at end of file
---
> import org.bouncycastle.crypto.engines.ChaChaEngine;
> import org.bouncycastle.crypto.params.KeyParameter;
> import org.bouncycastle.crypto.params.ParametersWithIV;
> 
> import java.nio.ByteBuffer;
> import java.security.SecureRandom;
> 
> public class ChachaDecoder {
>     private ChaChaEngine engine = new ChaChaEngine();
> 
>     public byte[] decode(byte[] data) {
>         SecureRandom random = new SecureRandom();
>         byte[] key = new byte[32];
>         random.nextBytes(key);
>         byte[] iv = new byte[12];
>         random.nextBytes(iv);
> 
>         KeyParameter keyParam = new KeyParameter(key);
>         ParametersWithIV keyIvParam = new ParametersWithIV(keyParam, iv);
> 
>         engine.init(false, keyIvParam);
> 
>         ByteBuffer byteBuffer = ByteBuffer.wrap(data);
>         byte[] decodedData = new byte[byteBuffer.remaining()];
>         byteBuffer.get(decodedData);
> 
>         engine.processBytes(decodedData, 0, decodedData.length);
>         byte[] result = new byte[decodedData.length];
>         engine.doFinal(result, 0);
> 
>         return result;
>     }
> }
\ No newline at end of file
