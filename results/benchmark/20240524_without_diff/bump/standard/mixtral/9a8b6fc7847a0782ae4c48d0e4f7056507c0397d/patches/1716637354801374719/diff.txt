0a1,13
> import it.geosolutions.geostore.core.security.password.SecurityUtils;
> import org.jasypt.encryption.pbe.StandardPBEStringEncryptor;
> import org.jasypt.spring.security.PBEPasswordEncoder;
> import org.springframework.security.crypto.password.PasswordEncoder;
> import org.springframework.util.StringUtils;
> 
> import java.security.KeyStore;
> import java.security.KeyStoreException;
> import java.security.NoSuchAlgorithmException;
> import java.security.UnrecoverableKeyException;
> import java.security.cert.CertificateException;
> import java.util.Arrays;
> 
2a16
>     try {
4,5c18
< 
<                 char[] chars = toChars(password);
---
>         char[] chars = SecurityUtils.toChars(password);
7c20
<                         stringEncrypter = new StandardPBEStringEncryptor();
---
>             StandardPBEStringEncryptor stringEncrypter = new StandardPBEStringEncryptor();
9d21
< 
14d25
< 
17d27
< 
20,21c30,34
<                         scramble(password);
<                         scramble(chars);
---
>             SecurityUtils.scramble(password);
>             SecurityUtils.scramble(chars);
>         }
>     } catch (KeyStoreException | NoSuchAlgorithmException | CertificateException | UnrecoverableKeyException e) {
>         throw new IllegalStateException("Failed to create password encoder.", e);
