1c1,5
< public void signPdf(Path pdfFile, Path outputFile, byte[] keyStore, char[] keyStorePassword, boolean binary, SignatureParameters params) throws IOException {
---
> import eu.europa.esig.dss.pades.CertificationPermission;
> import org.openpdfsign.Signer;
> import org.openpdfsign.dss.PdfBoxNativeTableObjectFactory;
> 
> public void signPdf(java.nio.file.Path pdfFile, java.nio.file.Path outputFile, byte[] keyStore, char[] keyStorePassword, boolean binary, SignatureParameters params) throws java.io.IOException {
7d10
< 
10d12
< 
12,13c14
<         JKSSignatureToken signingToken = new JKSSignatureToken(keyStore, new KeyStore.PasswordProtection(keyStorePassword));
< 
---
>     eu.europa.esig.dss.token.JKSSignatureToken signingToken = new eu.europa.esig.dss.token.JKSSignatureToken(keyStore, new java.security.KeyStore.PasswordProtection(keyStorePassword));
16c17
<         PAdESSignatureParameters signatureParameters = new PAdESSignatureParameters();
---
>     eu.europa.esig.dss.pades.PAdESSignatureParameters signatureParameters = new eu.europa.esig.dss.pades.PAdESSignatureParameters();
18,20c19,21
<         String keyAlias = "alias";
<         if (signingToken.getKeys().get(0) instanceof KSPrivateKeyEntry) {
<             keyAlias = ((KSPrivateKeyEntry) signingToken.getKeys().get(0)).getAlias();
---
>     java.lang.String keyAlias = "alias";
>     if (signingToken.getKeys().get(0) instanceof eu.europa.esig.dss.token.KSPrivateKeyEntry) {
>         keyAlias = ((eu.europa.esig.dss.token.KSPrivateKeyEntry) (signingToken.getKeys().get(0))).getAlias();
22d22
<         ;
25,26c25,26
<         if (params.getUseTimestamp() || !params.getTSA().isEmpty()) {
<             signatureParameters.setSignatureLevel(SignatureLevel.PAdES_BASELINE_T);
---
>     if (params.getUseTimestamp() || (!params.getTSA().isEmpty())) {
>         signatureParameters.setSignatureLevel(eu.europa.esig.dss.enumerations.SignatureLevel.PAdES_BASELINE_T);
28c28
<             signatureParameters.setSignatureLevel(SignatureLevel.PAdES_BASELINE_B);
---
>         signatureParameters.setSignatureLevel(eu.europa.esig.dss.enumerations.SignatureLevel.PAdES_BASELINE_B);
30,31c30
<         signatureParameters.setPermission(CertificationPermission.MINIMAL_CHANGES_PERMITTED);
< 
---
>     signatureParameters.setPermission(eu.europa.esig.dss.pades.CertificationPermission.MINIMAL_CHANGES_PERMITTED);
33c32
<         CommonCertificateVerifier commonCertificateVerifier = new CommonCertificateVerifier();
---
>     eu.europa.esig.dss.validation.CommonCertificateVerifier commonCertificateVerifier = new eu.europa.esig.dss.validation.CommonCertificateVerifier();
35,36c34
<         PAdESService service = new PAdESService(commonCertificateVerifier);
< 
---
>     eu.europa.esig.dss.pades.signature.PAdESService service = new eu.europa.esig.dss.pades.signature.PAdESService(commonCertificateVerifier);
38d35
< 
41c38
<             SignatureImageParameters imageParameters = new SignatureImageParameters();
---
>         eu.europa.esig.dss.pades.SignatureImageParameters imageParameters = new eu.europa.esig.dss.pades.SignatureImageParameters();
44,46c41,42
< 
<             if (!Strings.isStringEmpty(params.getImageFile())) {
<                 imageParameters.setImage(new InMemoryDocument(Files.readAllBytes(Paths.get(params.getImageFile()))));
---
>         if (!com.beust.jcommander.Strings.isStringEmpty(params.getImageFile())) {
>             imageParameters.setImage(new InMemoryDocument(java.nio.file.Files.readAllBytes(java.nio.file.Paths.get(params.getImageFile()))));
48c44
<                 imageParameters.setImage(new InMemoryDocument((IOUtils.toByteArray(getClass().getClassLoader().getResourceAsStream("signature.png")))));
---
>             imageParameters.setImage(new InMemoryDocument(org.apache.commons.io.IOUtils.toByteArray(getClass().getClassLoader().getResourceAsStream("signature.png"))));
50d45
< 
52c47
<                 PDDocument pdDocument = PDDocument.load(toSignDocument.openStream());
---
>             org.apache.pdfbox.pdmodel.PDDocument pdDocument = org.apache.pdfbox.pdmodel.PDDocument.load(toSignDocument.openStream());
57d51
< 
61,64c55,57
<             fieldParameters.setOriginX(params.getLeft() * POINTS_PER_MM * 10f);
<             fieldParameters.setOriginY(params.getTop() * POINTS_PER_MM * 10f);
<             fieldParameters.setWidth(params.getWidth() * POINTS_PER_MM * 10f);
< 
---
>         fieldParameters.setOriginX((params.getLeft() * Signer.POINTS_PER_MM) * 10.0F);
>         fieldParameters.setOriginY((params.getTop() * Signer.POINTS_PER_MM) * 10.0F);
>         fieldParameters.setWidth((params.getWidth() * Signer.POINTS_PER_MM) * 10.0F);
67c60
<             DateTimeFormatter formatter = DateTimeFormatter.ISO_OFFSET_DATE_TIME.withZone(ZoneId.systemDefault());
---
>         java.time.format.DateTimeFormatter formatter = java.time.format.DateTimeFormatter.ISO_OFFSET_DATE_TIME.withZone(java.time.ZoneId.systemDefault());
70c63
<                 formatter = formatter.withZone(ZoneId.of(params.getTimezone()));
---
>             formatter = formatter.withZone(java.time.ZoneId.of(params.getTimezone()));
74c67
<             if (!Strings.isStringEmpty(params.getHint())) {
---
>         if (!com.beust.jcommander.Strings.isStringEmpty(params.getHint())) {
79d71
< 
81,82d72
< 
< 
87d76
< 
92,94c81,83
<         if (params.getUseTimestamp() || params.getTSA() != null) {
<             CompositeTSPSource compositeTSPSource = new CompositeTSPSource();
<             Map<String, TSPSource> tspSources = new HashMap<>();
---
>     if (params.getUseTimestamp() || (params.getTSA() != null)) {
>         eu.europa.esig.dss.spi.x509.tsp.CompositeTSPSource compositeTSPSource = new eu.europa.esig.dss.spi.x509.tsp.CompositeTSPSource();
>         java.util.Map<java.lang.String, eu.europa.esig.dss.spi.x509.tsp.TSPSource> tspSources = new java.util.HashMap<>();
97,98c86,87
<                 Arrays.stream(Configuration.getInstance().getProperties().getStringArray("tsp_sources")).forEach(source -> {
<                     tspSources.put(source, new OnlineTSPSource(source));
---
>             java.util.Arrays.stream(Configuration.getInstance().getProperties().getStringArray("tsp_sources")).forEach(( source) -> {
>                 tspSources.put(source, new eu.europa.esig.dss.service.tsp.OnlineTSPSource(source));
101,102c90,91
<                 params.getTSA().stream().forEach(source -> {
<                     tspSources.put(source, new OnlineTSPSource(source));
---
>             params.getTSA().stream().forEach(( source) -> {
>                 tspSources.put(source, new eu.europa.esig.dss.service.tsp.OnlineTSPSource(source));
107d95
< 
109d96
< 
112c99
<         DigestAlgorithm digestAlgorithm = signatureParameters.getDigestAlgorithm();
---
>     eu.europa.esig.dss.enumerations.DigestAlgorithm digestAlgorithm = signatureParameters.getDigestAlgorithm();
115d101
< 
118c104,105
<         }*/
---
>     }
>      */
120d106
< 
124c110
<             signedDocument.writeTo(System.out);
---
>         signedDocument.writeTo(java.lang.System.out);
