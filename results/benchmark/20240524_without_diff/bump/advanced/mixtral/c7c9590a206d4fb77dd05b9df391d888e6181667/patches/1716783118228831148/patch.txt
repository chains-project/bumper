import org.apache.maven.doxia.siterenderer.SiteRenderer;
import org.apache.maven.doxia.siterenderer.sink.SiteRendererSink;
import org.apache.maven.project.MavenProject;
import org.codehaus.plexus.util.IOUtil;
import org.scoverage.reporting.html.HTMLReportGenerator;

import java.io.File;
import java.io.FileOutputStream;
import java.io.IOException;
import java.util.List;
import java.util.Map;

public void renderReport(MavenProject project, File outputDirectory) throws IOException {
    SiteRenderer siteRenderer = ... // initialize siteRenderer
    SiteRendererSink sink = siteRenderer.getSiteRendererSink();

    // Set up the rendering context
    RenderingContext renderingContext = new RenderingContext();
    renderingContext.put("project", project);
    renderingContext.put("outputDirectory", outputDirectory);

    // Generate the report
    HTMLReportGenerator generator = new HTMLReportGenerator();
    generator.generateReport(renderingContext, sink);

    // Write the output
    File outputFile = new File(outputDirectory, "index.html");
    try (FileOutputStream outputStream = new FileOutputStream(outputFile)) {
        IOUtil.copy(sink.asStream(), outputStream);
    }
}