@Override
public void init(OutputStream os) {
  this.os = os;
  // Use the TFramedTransport to be compatible with singer_thrift
  // log.
  final int bufferCapacity = 10;
  TTransport transport = new TIOStreamTransport(os);
  TFramedTransport framedTransport = new TFramedTransport(transport, bufferCapacity);
  TProtocol protocol = new TBinaryProtocol(framedTransport);
  framedTransport.open();
}