@Override
public void init(OutputStream os) {
  this.os = os;
  // Use the TFramedTransport to be compatible with singer_thrift
  final int bufferCapacity = 10;
  TTransport transport = new TFramedTransport(new TIOStreamTransport(os));
  protocol = new TBinaryProtocol(new TTransportLayer(transport){
    @Override
    public TTransport getUnderlyingTransport() {
      return transport;
    }
  });
}