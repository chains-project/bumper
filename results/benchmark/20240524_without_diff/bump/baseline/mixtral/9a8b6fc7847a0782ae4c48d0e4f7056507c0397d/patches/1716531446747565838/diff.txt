1c1,30
< import org.jasypt.spring.security.PBEPasswordEncoder;
\ No newline at end of file
---
> import org.jasypt.util.password.ConfigurablePasswordEncoder;
> 
> @Component
> @RequiredArgsConstructor
> public class GeoStorePBEPasswordEncoder {
> 
>     private final TextEncryptor textEncryptor;
> 
>     @PostConstruct
>     public void init() {
>         ConfigurablePasswordEncoder passwordEncoder = new ConfigurablePasswordEncoder();
>         passwordEncoder.setAlgorithm("PBEWithMD5AndTripleDES");
>         passwordEncoder.setKeyObtentionIterations(1000);
>         passwordEncoder.setPoolSize(1);
>         passwordEncoder.setProviderName("SunJCE");
>         passwordEncoder.setSaltGenerator(new RandomSaltGenerator());
>         passwordEncoder.setStringOutputType("base64");
>         textEncryptor.setPasswordEncoder(passwordEncoder);
>     }
> 
>     @Override
>     public String encodePassword(String rawPass, Object salt) {
>         return textEncryptor.encryptPassword(rawPass);
>     }
> 
>     @Override
>     public boolean isPasswordValid(String encPass, String rawPass, Object salt) {
>         return textEncryptor.checkPassword(rawPass, encPass);
>     }
> }
\ No newline at end of file
