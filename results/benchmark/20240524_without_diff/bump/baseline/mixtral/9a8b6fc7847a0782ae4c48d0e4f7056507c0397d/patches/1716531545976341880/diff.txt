15,16c15,16
<                         PBEPasswordEncoder encoder = new PBEPasswordEncoder();
<                         encoder.setPbeStringEncryptor(stringEncrypter);
---
>         TextEncryptor encryptor = new org.jasypt.util.text.StrongTextEncryptor();
>         encryptor.setPasswordCharArray(chars);
18c18,28
<                         return encoder;
---
>         return new org.jasypt.spring.security.PasswordEncoder() {
>             @Override
>             public String encodePassword(String rawPass, Object salt) {
>                 return encryptor.encrypt(rawPass);
>             }
> 
>             @Override
>             public boolean isPasswordValid(String encPass, String rawPass, Object salt) {
>                 return encPass.equals(encryptor.encrypt(rawPass));
>             }
>         };
