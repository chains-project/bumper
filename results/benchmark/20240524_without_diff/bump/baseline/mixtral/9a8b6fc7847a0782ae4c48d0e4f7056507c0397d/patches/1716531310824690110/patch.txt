import org.jasypt.util.password.StrongPasswordEncryptor;
import org.springframework.security.crypto.password.PasswordEncoder;
import org.springframework.security.crypto.password.Pbkdf2PasswordEncoder;

@Override
public PasswordEncoder passwordEncoder() {
    StrongPasswordEncryptor encryptor = new StrongPasswordEncryptor();
    return new Pbkdf2PasswordEncoder(encryptor.getAlgorithmName(), encryptor.getIterationCount()) {
        @Override
        public boolean matches(CharSequence rawPassword, String encodedPassword) {
            return encryptor.checkPassword(rawPassword.toString(), encodedPassword);
        }
    };
}