0a1,12
> import org.apache.maven.doxia.sink.Sink;
> import org.apache.maven.doxia.sink.SinkEventAttributes;
> import org.apache.maven.doxia.sink.impl.AbstractContentBuilder;
> import org.apache.maven.doxia.sink.impl.switchable.MavenReportSwitchable;
> import org.apache.maven.doxia.sink.impl.switchable.SwitchableContentBuilder;
> import org.apache.maven.doxia.sink.impl.switchable.SwitchableContentBuilderDecorator;
> import org.apache.maven.plugins.annotations.ResolutionScope;
> import org.apache.maven.project.MavenProject;
> 
> import java.io.File;
> import java.util.Locale;
> 
18,19c30,33
<             RenderingContext context = new RenderingContext( outputDirectory, getOutputName() + ".html" );
<             SiteRendererSink sink = new SiteRendererSink( context );
---
>         File outputDirectory = new File( this.outputDirectory );
>         String outputName = getOutputName();
>         Sink sink = new SiteRendererSink( new RenderingContext( outputDirectory, outputName + ".html" ) );
>         MavenProject project = (MavenProject) getProject();
21c35,38
<             generate( sink, locale );
---
>         generate( new SwitchableContentBuilderDecorator(
>                 new MavenReportSwitchable( new SwitchableContentBuilder( new AbstractContentBuilder( sink ) ) ),
>                 new ReportContentBuilderFactory( project, locale ) ),
>                 locale );
28a46,70
> 
> private static class ReportContentBuilderFactory implements SwitchableContentBuilderFactory {
>     private final MavenProject project;
>     private final Locale locale;
> 
>     public ReportContentBuilderFactory(MavenProject project, Locale locale) {
>         this.project = project;
>         this.locale = locale;
>     }
> 
>     @Override
>     public Sink createSink() {
>         return new SiteRendererSink( new RenderingContext( project.getBuild().getDirectory(), "index.html" ) );
>     }
> 
>     @Override
>     public SinkEventAttributes createAttributes() {
>         return new SinkEventAttributes();
>     }
> 
>     @Override
>     public Locale getLocale() {
>         return locale;
>     }
> }
\ No newline at end of file
