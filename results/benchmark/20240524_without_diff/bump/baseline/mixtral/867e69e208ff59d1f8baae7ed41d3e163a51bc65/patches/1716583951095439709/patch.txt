import org.apache.thrift.transport.TTransport;

import java.io.ByteArrayOutputStream;
import java.io.IOException;
import java.util.zip.GZIPOutputStream;

public class SimpleThriftLogger {

    // ...

    @Override
    public void log(String jsonMessage) {
        TTransport transport = new TFramedTransport(new NoopTransport());
        try (TProtocol protocol = new TBinaryProtocol(transport)) {
            // ...
        } catch (TException e) {
            // ...
        } finally {
            try {
                transport.close();
            } catch (TTransportException e) {
                // swallow it
            }
        }
    }

    // ...

    private static class NoopTransport implements TTransport {

        @Override
        public void open() throws TTransportException {
            // no-op
        }

        @Override
        public void close() throws TTransportException {
            // no-op
        }

        @Override
        public boolean isOpen() {
            return false;
        }

        @Override
        public int read(byte[] buf, int off, int len) throws TTransportException {
            return 0;
        }

        @Override
        public void write(byte[] buf, int off, int len) throws TTransportException {
            // no-op
        }

        @Override
        public void flush() throws TTransportException {
            // no-op
        }
    }
}