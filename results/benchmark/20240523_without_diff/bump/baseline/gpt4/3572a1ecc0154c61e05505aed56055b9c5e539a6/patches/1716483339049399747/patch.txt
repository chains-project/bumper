  @Override
    public void init(OutputStream os) {
      this.os = os;
      // Use the TFlushingFastFramedTransport to be compatible with singer_thrift
      // log.
      final int bufferCapacity = 10;
      TTransport transport = new TIOStreamTransport(os);
      framedTransport = new TFramedTransport(transport, bufferCapacity);
      protocol = new TBinaryProtocol(framedTransport);
    }