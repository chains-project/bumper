1c1,67
< import org.bouncycastle.crypto.tls.AlertDescription;
\ No newline at end of file
---
> import java.io.IOException;
> import java.util.HashMap;
> import java.util.Map;
> 
> import org.bouncycastle.crypto.CipherParameters;
> import org.bouncycastle.crypto.StreamCipher;
> import org.bouncycastle.crypto.params.ParametersWithIV;
> import org.bouncycastle.crypto.params.KeyParameter;
> import org.bouncycastle.util.encoders.Hex;
> 
> public class ChachaDecoder {
>     // ...
> 
>     private static final Map<Integer, AlertDescription> alertDescriptions = new HashMap<>();
> 
>     static {
>         alertDescriptions.put(20, AlertDescription.decode(20));
>         alertDescriptions.put(10, AlertDescription.decode(10));
>         // ...
>     }
> 
>     private void decodeAlert(InputStream in) throws IOException {
>         int alertLevel = in.read();
>         int alertDescription = in.read();
>         AlertDescription description = alertDescriptions.get(alertDescription);
>         if (description == null) {
>             throw new TlsFatalAlert(AlertDescription.illegal_parameter);
>         }
>         throw new TlsFatalAlert(alertLevel, description);
>     }
> 
>     // ...
> }
> 
> class TlsFatalAlert {
>     private final short alertLevel;
>     private final AlertDescription alertDescription;
> 
>     public TlsFatalAlert(short alertLevel, AlertDescription alertDescription) {
>         this.alertLevel = alertLevel;
>         this.alertDescription = alertDescription;
>     }
> 
>     public short getAlertLevel() {
>         return alertLevel;
>     }
> 
>     public AlertDescription getAlertDescription() {
>         return alertDescription;
>     }
> 
>     // ...
> }
> 
> class AlertDescription {
>     private final int value;
> 
>     private AlertDescription(int value) {
>         this.value = value;
>     }
> 
>     public static AlertDescription decode(int value) {
>         return new AlertDescription(value);
>     }
> 
>     // ...
> }
\ No newline at end of file
