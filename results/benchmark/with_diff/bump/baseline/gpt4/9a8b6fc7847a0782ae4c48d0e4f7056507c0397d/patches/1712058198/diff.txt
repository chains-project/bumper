15,16c15,19
<                         PBEPasswordEncoder encoder = new PBEPasswordEncoder();
<                         encoder.setPbeStringEncryptor(stringEncrypter);
---
>         return new PasswordEncoder() {
>             @Override
>             public String encode(CharSequence rawPassword) {
>                 return stringEncrypter.encryptString(rawPassword.toString());
>             }
18c21,25
<                         return encoder;
---
>             @Override
>             public boolean matches(CharSequence rawPassword, String encodedPassword) {
>                 return stringEncrypter.decryptString(encodedPassword).equals(rawPassword.toString());
>             }
>         };
