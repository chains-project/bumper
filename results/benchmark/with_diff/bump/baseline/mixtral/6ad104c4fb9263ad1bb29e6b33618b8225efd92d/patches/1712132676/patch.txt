import org.bouncycastle.crypto.tls.TlsFatalAlert;
import org.bouncycastle.crypto.tls.AlertDescription;

// ...

@Override
protected void decode(ChannelBuffer buffer) throws IOException {
    try {
        version = TlsUtils.readVersion(buffer);
        clientRandom = new byte[32];
        serverRandom = new byte[32];

        buffer.readBytes(clientRandom);
        buffer.readBytes(serverRandom);

        int macLength = buffer.readUnsignedByte();
        int ciphertextLength = buffer.readableBytes() - 2;

        if (macLength > 0) {
            throw new TlsFatalAlert(TlsFatalAlert.DECODE_ERROR, AlertDescription.internalError());
        }

        byte[] ciphertext = new byte[ciphertextLength];
        buffer.readBytes(ciphertext);

        // Decode the ciphertext using the ChaCha20Poly1305 cipher.
        // ...

    } catch (TlsFatalAlert ex) {
        throw ex;
    } catch (Exception ex) {
        throw new TlsFatalAlert(TlsFatalAlert.DECODE_ERROR, AlertDescription.internalError());
    }
}