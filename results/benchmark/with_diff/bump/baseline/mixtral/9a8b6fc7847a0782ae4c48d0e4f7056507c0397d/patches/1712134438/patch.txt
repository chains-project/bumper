import org.jasypt.util.text.TextEncryptor;
import org.jasypt.encryption.pbe.PBEStringEncryptor;
import org.jasypt.util.password.PasswordEncryptor;
import org.jasypt.digest.StringDigester;
import org.springframework.security.crypto.password.PasswordEncoder;
import org.springframework.context.annotation.Bean;

@Bean
public PBEPasswordEncoder geoStorePBEPasswordEncoder() {
    PBEStringEncryptor pbeStringEncryptor = new PBEStringEncryptor();
    TextEncryptor textEncryptor = pbeStringEncryptor;
    PasswordEncoder passwordEncoder = new PasswordEncoder() {
        @Override
        public String encode(String rawPassword) {
            return textEncryptor.encrypt(rawPassword);
        }

        @Override
        public boolean matches(String rawPassword, String encodedPassword) {
            return textEncryptor.decrypt(encodedPassword).equals(rawPassword);
        }
    };
    passwordEncoder.setPasswordEncryptor(pbeStringEncryptor);
    StringDigester stringDigester = new StringDigester();
    passwordEncoder.setStringDigester(stringDigester);
    return (PBEPasswordEncoder) passwordEncoder;
}