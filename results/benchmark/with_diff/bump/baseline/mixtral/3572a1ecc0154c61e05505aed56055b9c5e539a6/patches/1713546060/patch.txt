import org.apache.thrift.transport.TIOStreamTransport;
import org.apache.thrift.transport.TTransport;
import java.io.ByteArrayOutputStream;
import java.io.ByteArrayInputStream;

// ...

private static TTransport createFastFramedTransport(TTransport transport) {
    TIOStreamTransport iostreamTransport = new TIOStreamTransport(new TConfiguration(), new ByteArrayOutputStream());
    iostreamTransport.setInputTransport(transport);
    return iostreamTransport;
}

// Replace the following line:
// TFastFramedTransport transport = new TFastFramedTransport(new TFramedTransport(new TSocket(host, port)));

TFastFramedTransport transport = new TFastFramedTransport(createFastFramedTransport(new TSocket(host, port)));