import org.jasypt.encryption.pbe.PBEStringEncryptor;
import org.jasypt.util.text.TextEncryptor;
import org.jasypt.util.password.PasswordEncryptor;
import org.springframework.security.authentication.encoding.PasswordEncoder;
import org.springframework.security.crypto.password.StandardPasswordEncoder;

public class GeoStoreDigestPasswordEncoder implements PasswordEncoder {

    private final PasswordEncoder passwordEncoder;

    public GeoStoreDigestPasswordEncoder() {
        PasswordEncryptor passwordEncryptor = new PasswordEncryptor();
        PBEStringEncryptor pbeStringEncryptor = new PBEStringEncryptor();
        TextEncryptor textEncryptor = new TextEncryptor();
        textEncryptor.setPasswordEncryptor(passwordEncryptor);
        pbeStringEncryptor.setPassword(passwordEncryptor.encryptPassword("geostore", "salt"));
        passwordEncryptor.setAlgorithm("SHA-256");
        passwordEncryptor.setIterationCount(1024);
        passwordEncryptor.setKeyObtentionIterations(1024);
        passwordEncryptor.setPoolSize(1);
        passwordEncryptor.setProviderName("SunJCE");
        passwordEncryptor.setSaltGenerator(new RandomSaltGenerator());
        this.passwordEncoder = new StandardPasswordEncoder();
        this.passwordEncoder.setPasswordEncoder(passwordEncryptor);
        this.passwordEncoder.setEncryptor(passwordEncryptor);
        this.passwordEncoder.setTextEncryptor(textEncryptor);
        this.passwordEncoder.setPbeStringEncryptor(pbeStringEncryptor);
    }

    @Override
    public String encodePassword(String rawPass, Object salt) {
        return passwordEncoder.encodePassword(rawPass, salt);
    }

    @Override
    public boolean isPasswordValid(String encPass, String rawPass, Object salt) {
        return passwordEncoder.isPasswordValid(encPass, rawPass, salt);
    }
}