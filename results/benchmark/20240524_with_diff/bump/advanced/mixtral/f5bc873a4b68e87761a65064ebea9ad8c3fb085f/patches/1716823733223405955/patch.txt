import org.apache.maven.model.Model;
import org.apache.maven.project.MavenProject;
import org.eclipse.aether.RepositorySystem;
import org.eclipse.aether.RepositorySystemSession;
import org.eclipse.aether.collection.CollectRequest;
import org.eclipse.aether.collection.CollectResult;
import org.eclipse.aether.repository.RemoteRepository;
import org.eclipse.aether.util.artifact.JavaArtifact;

// ...

public void resolveProjectDependencies(Model model, RepositorySystem repoSystem, RepositorySystemSession repoSession) throws Exception {
    // -- old code

    CollectRequest collectRequest = new CollectRequest();
    collectRequest.setRoot(new JavaArtifact(model.getGroupId(), model.getArtifactId(), model.getVersion(), JavaScopes.COMPILE));
    collectRequest.setRepositories(repositories);

    CollectResult collectResult = repoSystem.collectDependencies(repoSession, collectRequest);

    // new code
    for (Dependency dependency : model.getDependencies()) {
        Artifact artifact = repoSystem.createArtifact(dependency.getGroupId(), dependency.getArtifactId(), dependency.getVersion(), dependency.getScope(), null);
        collectRequest.addArtifact(artifact);
    }
    collectResult = repoSystem.collectDependencies(repoSession, collectRequest);

    // -- rest of the old code
}