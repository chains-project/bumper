1c1,29
< import org.bouncycastle.crypto.tls.AlertDescription;
\ No newline at end of file
---
> import java.io.IOException;
> import java.util.logging.Level;
> import java.util.logging.Logger;
> import org.bouncycastle.crypto.params.KeyParameter;
> import org.bouncycastle.util.Arrays;
> 
> public class ChachaDecoder {
>     // ...
> 
>     private void decodeHandshakeMessage(byte[] input, int length) throws IOException {
>         // ...
> 
>         try {
>             switch (type) {
>                 case 20:
>                     if (length < 64) {
>                         throw new TlsFatalAlert(AlertDescription.decode(AlertDescription.illegal_parameter));
>                     }
>                     // ...
>                 // ...
>             }
>         } catch (TlsFatalAlert ex) {
>             logger.log(Level.FINE, "decryption failed: {0}", ex.getMessage());
>             throw new TlsFatalAlert(ex.getAlertDescription());
>         }
>     }
> 
>     // ...
> }
\ No newline at end of file
