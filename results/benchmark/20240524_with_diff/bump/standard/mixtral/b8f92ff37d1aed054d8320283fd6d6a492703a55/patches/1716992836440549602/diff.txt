0a1,13
> import org.apache.maven.plugin.surefire.booterclient.Commandline;
> import org.apache.maven.plugin.surefire.booter.StartupConfiguration;
> import org.apache.maven.plugin.surefire.booterclient.lazytestprovider.CommandlineParameters;
> import org.apache.maven.plugin.surefire.provider.ProviderParameters;
> import org.apache.maven.plugin.surefire.report.ReportEntry;
> import org.apache.maven.plugin.surefire.report.ReportsMerger;
> import org.apache.maven.plugin.surefire.util.SurefireReflectionUtils;
> 
> import java.io.File;
> import java.util.ArrayList;
> import java.util.Collection;
> import java.util.List;
> 
2,3c15,34
<         DirectoryScanner directoryScanner = new DirectoryScanner(testSrcFolder, TestListResolver.getWildcard());
<         return directoryScanner.scan().getClasses();
---
>     Commandline commandLine = new DefaultForkConfiguration().createCommandLine(new StartupConfiguration(), 1, testSrcFolder);
>     ProviderParameters providerParams = new ProviderParameters();
>     providerParams.setCommandline(commandLine);
>     CommandlineParameters commandlineParameters = new CommandlineParameters();
>     commandlineParameters.setProviderParameters(providerParams);
>     ReportEntry reportEntry = new ReportEntry();
>     reportEntry.setReportDirectory(new ReportsMerger().getReportsDirectory());
>     reportEntry.setReportFiles(new ArrayList<File>());
>     reportEntry.setReportName("surefire-reports");
>     reportEntry.setReportPackageName("surefire-reports");
>     reportEntry.setReportTimestamp(SurefireReflectionUtils.getTimeStamp());
>     reportEntry.setReportTypes(new ArrayList<String>());
>     reportEntry.setRunOrder(0);
>     List<ReportEntry> reportEntries = new ArrayList<ReportEntry>();
>     reportEntries.add(reportEntry);
>     commandlineParameters.setReportEntries(reportEntries);
>     commandlineParameters.setSurefireArgLine(new ArrayList<String>());
>     commandlineParameters.setSystemProperties(new ArrayList<String>());
>     commandLine.setCommandlineParameters(commandlineParameters);
>     return new DirectoryScanner(testSrcFolder, commandLine).scan().getClasses();
