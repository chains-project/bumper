1c1
< @Override
---
> @java.lang.Override
3,8c3,10
< 
<         PerforceScm perforceScm = getJenkinsScm();
<         String credentials = perforceScm.getCredential();
< 
<         ConnectionHelper connection = new ConnectionHelper(credentials, buildListener);
<         IOptionsServer server = ConnectionFactory.getConnection();
---
>     org.jenkinsci.plugins.p4.PerforceScm perforceScm = getJenkinsScm();
>     java.lang.String credentials = perforceScm.getCredential();
>     hudson.model.ItemGroup parent = perforceScm.getParent();
>     hudson.model.Item project = perforceScm.getProject();
>     hudson.model.TaskListener buildListener = getBuild().getListener();
>     org.jenkinsci.plugins.p4.workspace.Workspace workspace = perforceScm.getWorkspace();
>     org.jenkinsci.plugins.p4.client.ConnectionHelper connection = new org.jenkinsci.plugins.p4.client.ConnectionHelper(credentials, buildListener);
>     com.perforce.p4java.server.IOptionsServer server = org.jenkinsci.plugins.p4.client.ConnectionFactory.getConnection();
10c12
<             String clientString = getClientString();
---
>         java.lang.String clientString = getClientString();
12,13c14,15
<                 ClientHelper perforceClient = new ClientHelper(credentials, buildListener, clientString, StandardCharsets.UTF_8.toString());
<                 IClient client = perforceClient.getClient();
---
>             org.jenkinsci.plugins.p4.client.ClientHelper perforceClient = new org.jenkinsci.plugins.p4.client.ClientHelper(parent, credentials, buildListener, workspace);
>             com.perforce.p4java.client.IClient client = perforceClient.getClient();
15c17
<                     this.perforce = new PerforceClient(server, client);
---
>                 this.perforce = new org.jfrog.build.vcs.perforce.PerforceClient(server, client);
17,18c19,20
<                 } catch (Exception e) {
<                     logger.warning("Could not instantiate connection with PerforceClient: " + e.getMessage());
---
>             } catch (java.lang.Exception e) {
>                 org.jfrog.hudson.release.scm.perforce.P4Manager.logger.warning("Could not instantiate connection with PerforceClient: " + e.getMessage());
21c23
<                 logger.warning("Client " + clientString + " is not a valid client.");
---
>             org.jfrog.hudson.release.scm.perforce.P4Manager.logger.warning(("Client " + clientString) + " is not a valid client.");
23,24c25,26
<         } catch (Exception e) {
<             logger.log(Level.FINE, "Error occurred: ", e);
---
>     } catch (java.lang.Exception e) {
>         org.jfrog.hudson.release.scm.perforce.P4Manager.logger.log(java.util.logging.Level.FINE, "Error occurred: ", e);
26d27
< 
