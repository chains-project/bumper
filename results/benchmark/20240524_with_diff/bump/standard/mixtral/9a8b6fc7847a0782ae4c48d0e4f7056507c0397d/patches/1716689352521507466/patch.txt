import org.jasypt.encryption.pbe.PBEStringEncryptor;
import org.jasypt.util.text.TextEncryptor;
import org.springframework.security.crypto.password.PasswordEncoder;
import org.springframework.security.crypto.password.Pbkdf2PasswordEncoder;

import java.util.Objects;

public class GeoStorePBEPasswordEncoder {

    private final PasswordEncoder passwordEncoder;

    public GeoStorePBEPasswordEncoder() {
        TextEncryptor textEncryptor = new TextEncryptor() {
            private final PBEStringEncryptor encryptor = new PBEStringEncryptor() {
                {
                    setAlgorithm("PBEWithMD5AndTripleDES");
                    setPassword("password");
                }
            };

            @Override
            public String encrypt(String text) {
                return encryptor.encrypt(text);
            }

            @Override
            public String decrypt(String encryptedText) {
                return encryptor.decrypt(encryptedText);
            }
        };

        passwordEncoder = new Pbkdf2PasswordEncoder(textEncryptor);
    }

    // ...
}