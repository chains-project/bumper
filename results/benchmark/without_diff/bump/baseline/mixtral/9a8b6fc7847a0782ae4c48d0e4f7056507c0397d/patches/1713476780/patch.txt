import org.jasypt.util.text.StrongTextEncryptor;

@Component
public class GeoStorePBEPasswordEncoder {

    @Value("${jasypt.password}")
    private String password;

    private StrongTextEncryptor encryptor = new StrongTextEncryptor();

    @PostConstruct
    public void init() {
        encryptor.setPassword(password);
    }

    @Override
    public String encode(String rawPass) {
        return encryptor.encrypt(rawPass);
    }

    @Override
    public boolean matches(String encPass, String rawPass) {
        return encPass.equals(encryptor.encrypt(rawPass));
    }
}