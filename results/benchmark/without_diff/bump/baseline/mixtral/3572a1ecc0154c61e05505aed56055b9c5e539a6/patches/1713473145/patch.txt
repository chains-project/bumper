import org.apache. thrift.transport.TTransport;
import org.apache. thrift.transport.TTransportException;

private static TTransport createFastFramedTransport(InputStream input) {
    TTransport transport = new TFramedTransport(new TTransport(input));
    try {
        transport.open();
    } catch (TTransportException e) {
        throw new RuntimeException("Failed to open transport", e);
    }
    return transport;
}