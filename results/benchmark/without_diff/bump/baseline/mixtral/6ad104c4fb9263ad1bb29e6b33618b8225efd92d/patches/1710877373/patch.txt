-import org.bouncycastle.jce.provider.JceTls;
+import javax.net.ssl.SSLContext;
+import javax.net.ssl.SSLServerSocketFactory;
+import javax.net.ssl.TlsClientProtocolVersionSelector;
+import java.security.Security;
+import java.security.SecurityProvider;
+import java.security.SecurityProviderException;
+import java.util.ServiceLoader;

- SSLServerSocketFactory sslServerSocketFactory = new JceTls().createSSLServerSocketFactory(null);
+ SSLServerSocketFactory sslServerSocketFactory = null;
+ try {
+     SecurityProvider sp = ServiceLoader.load(SecurityProvider.class).findFirst().get();
+     Security.addProvider(sp);
+     SSLContext sslContext = SSLContext.getInstance("TLSv1.2", sp.getName());
+     sslContext.init(null, null, null);
+     sslServerSocketFactory = sslContext.getServerSocketFactory();
+ } catch (Exception e) {
+     throw new SecurityException("Failed to initialize SSL context", e);
+ }