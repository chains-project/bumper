import org.bouncycastle.jce.provider.BouncyCastleProvider;

// add this line at the beginning of the method
Security.addProvider(new BouncyCastleProvider());

import org.bouncycastle.crypto.tls.TlsDecoder;
import org.bouncycastle.crypto.tls.TlsUtils;
import org.bouncycastle.crypto.tls.crypto.TlsCrypto;
import org.bouncycastle.crypto.tls.crypto.TlsSigner;

// replace the original import statement
// import org.bouncycastle.crypto.tls.AlertDescription;
with these three import statements
import org.bouncycastle.crypto.tls.AlertDescription;
import org.bouncycastle.crypto.tls.TlsFatalAlert;
import org.bouncycastle.crypto.tls.TlsUtils;

// replace the original method body
// TlsUtils.checkUint16(version, 0x0303);
// TlsUtils.checkUint16(length, 5 + macLength);
with these lines of code
TlsUtils.checkUint16(version, TlsUtils.TLS_1_3_VERSION);
TlsUtils.checkUint16(length, 5 + TlsUtils.MAC_SIZE_SHA256);