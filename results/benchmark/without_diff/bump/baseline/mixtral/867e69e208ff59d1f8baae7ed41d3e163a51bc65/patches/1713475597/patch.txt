import org.apache.thrift.transport.TTransport;

import java.io.IOException;
import java.io.OutputStream;

public class SimpleThriftLogger {
    // ...

    @Override
    public void log(String msg) throws IOException {
        try (TTransport transport = new org.apache.thrift.transport.TFramedTransport(new org.apache.thrift.transport.TSocket(host, port))) {
            OutputStream output = transport.getOutputStrem();
            output.write(msg.getBytes());
            output.flush();
        }
    }

    // ...
}